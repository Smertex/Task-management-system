# Система управления задачами
### Требования к технологиям API
* Java 17+
* Spring
  * Spring Boot
  * Spring Security
* PostgreSQL / MySQL
* JWT authentication
* Open API, Swagger, настройка Swagger UI
* Docker, docker-compose

### Требования к возможностям API
* Авторизация и аутентификация по email и паролю
* Ролевая система "Пользователь/Администратор"
  * Администратор может управлять всеми задачами: создавать новые, редактировать существующие, просматривать и удалять, менять статус и приоритет, назначать исполнителей задачи, оставлять комментарии
  * Пользователи могут управлять своими задачами, если указаны как исполнитель: менять статус, оставлять комментарии
* API должно позволять получать задачи конкретного автора или исполнителя, а также все комментарии к ним. Необходимо обеспечить фильтрацию и пагинацию вывода
* Сервис должен корректно обрабатывать ошибки и возвращать понятные сообщения, а также валидировать входящие данные
* Сервис должен быть хорошо задокументирован. API должен быть описан с помощью Open API и Swagger
* Тестирование основных модулей

### Дополнительные технологии, которые применяются в API
* Liquibase
* Lombok
* JJWT (version 0.9.1)

### Описание API
Данный API представляет собой микросервис, обеспечивающий работу с задачами. Аутентификация и авторизация основаны на JWT-токене. Для развертывания базы данных используются DDL-скрипты, 
а также Liquibase. Базовая конфигурация проекта обеспечивает CORS доступ с данных адресов:
1. https://editor.swagger.io/
2. http://localhost:8080/
3. http://localhost:8095/

Основаная конфигурация микросервиса лежит по следующему пути: **Task-management-system\src\main\resource**
В нем можно сконфигурировать следующие элементы:
* **jwt.yml** - конфигурация JWT-токена. В базовой настройке имеет жизненный цикл 5 часов. Также по этому пути лежит секретный ключ, в данном варианте он является тестовым
* **application.yml** - конфигурация самого микросервиса лежит здесь. В данной файле можно изменить параметры для подключения к базе данных. В базовой конфигурации данные параметры настроены на базу данных, которая находится внутри Docker. Подробности будут указаны ниже
* **swagger.yml** - параметры для конфигурации Swagger UI
* **swagger-ui.yml** - параметры для сборки Swagger UI

Доступ к адресам обеспечен следующим образом:
* **/api/auth** - открытый для всех пользователей путь, по котором происходит прием JSON для дальнейшей регистрации
* **/swagger-ui/**, **/v3/api-docs**, **/api/task/_task_uuid_ (method DELETE)** - пути, доступные только пользователям с ролью ADMIN
* **/api/** - остальные пути доступны только авторизированным в системе пользователям

### Инструкции для проведения тестирования
Для того, чтобы провести тестирования без развертывания Docker, необходимо изменить параметры для подключения к базе данных. Как уже было описано выше, базовая конфигурация предполагает запуск всей системы на Docker. То есть заменить следующие значение в **application.yml**:
* spring.application.datasource.url
* spring.application.datasource.username
* spring.application.datasource.password

### Инструкции для локального запуска проекта
1. Для начала необходимо установить с официального сайта программное обеспечение для автоматизации развертывания и управления приложениями в средах с поддержкой контейнеризации. В данной задаче в роли данного ПО выступает Docker https://www.docker.com/products/docker-desktop/
2. После установки, в случае с Windows, необходимо установить переменные среды. Для этого следует перейти по пути **This PC**. Далее нужно перейти в **Свойства** по средством нажатия правой кнопки мыши. Далее нажать **Дополнительные параметры системы** -> **Переменные среды** -> **Переменные среды для пользователя** -> **PATH**. Здесь необходимо добавить следующий путь к Docker **your_path\Docker\resources\bin**
3. Теперь необходимо установить данный микросервис с **GitHub** и сохранить его по удобному для вас пути
4. После выполнения всех действий выше, можно приступать к запуску самого микросервиса. Для этого следует выполнить следующие команды:
   1. **cd your_path_for_the_project\Task-management-system** - переход в нужный каталог
   2. **docker-compose up -d** - обеспечивает создание и запуск всех нужных контейнеров, определенных в файле **docker-compose**

После выполнения данных шагов, приложение будет запущено в среде Docker. Далее, чтобы остановить и удалить микросервис из Docker, необходимо выполнить следующие команды:
1. **docker-compose down -v** - останавливает и удаляет все контейнеры
2. **docker volume rm volume_name** - позволяет удалить нужный том. В вашем случае нужно вызвать следующие две команды:
   1. **docker rmi task-management-system-app**
   2. **docker rmi postgres**
3. **docker rmi image_name_or_id** - удаляет нужный образ. В вашем случае нужно вызвать следующее:
   1. **docker volume rm task-management-system_pg_task-management-system**

## Инструкция для тестирования контроллеров
1. Локально запустить проект по инструкции выше
2. Перейти по данной ссылке https://editor.swagger.io/
3. Скопировать все содержимое из **swagger-ui.yml** файла, путь к которому был указан выше, и вставить все редактор Swagger

## Дополнительная информация
* Внутренний порт базы данных 5432, а внешний 5434. База данных ограничена по подключениям, они возможны только с локального IP-адреса 127.0.0.1
* Внутренний порт приложения 8080, а внешний 8095
    
